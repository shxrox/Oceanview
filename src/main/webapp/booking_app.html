<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Confirm Booking</title>
  <style>
    body { background: #f4f6f7; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif; }
    .card { background: white; padding: 30px; border-radius: 8px; width: 400px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .summary { background: #ecf0f1; padding: 15px; margin-bottom: 20px; border-radius: 5px; font-size: 14px; }
    input { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    button { width: 100%; padding: 12px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer; }
  </style>
</head>
<body>

<div class="card">
  <h2>Guest Details</h2>
  <div class="summary">
    <p><strong>Room:</strong> <span id="sRoom"></span></p>
    <p><strong>Dates:</strong> <span id="sDates"></span></p>
    <p><strong>Price:</strong> $<span id="sPrice"></span></p>
  </div>

  <form onsubmit="confirmBooking(event)">
    <input type="text" id="name" placeholder="Guest Name" required>
    <input type="email" id="email" placeholder="Email Address" required>
    <input type="tel" id="phone" placeholder="Phone Number" required>
    <button type="submit" id="btn">Confirm Reservation</button>
  </form>
  <div style="text-align: center; margin-top: 10px;">
    <a href="search_app.html" style="color: #7f8c8d; text-decoration: none;">Cancel</a>
  </div>
</div>

<script>
  const params = new URLSearchParams(window.location.search);
  document.getElementById('sRoom').innerText = params.get('room');
  document.getElementById('sPrice').innerText = params.get('price');
  document.getElementById('sDates').innerText = `${params.get('in')} to ${params.get('out')}`;

  async function confirmBooking(e) {
    e.preventDefault();
    document.getElementById('btn').innerText = "Processing...";

    const data = new URLSearchParams();
    data.append('roomId', params.get('id'));
    data.append('checkIn', params.get('in'));
    data.append('checkOut', params.get('out'));
    data.append('name', document.getElementById('name').value);
    data.append('email', document.getElementById('email').value);
    data.append('phone', document.getElementById('phone').value);

    const res = await fetch('bookRoom', { method: 'POST', body: data });
    const json = await res.json();

    if(json.status === 'success') {
      alert("Booking Confirmed! Email Sent.");
      window.location.href = 'receptionist_dashboard.html';
    } else {
      alert("Error: " + json.message);
    }
  }
</script>

</body>
</html>